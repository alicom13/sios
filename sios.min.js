class Sios{constructor(c={}){this.defaults={baseURL:'',timeout:5e3,headers:{'Content-Type':'application/json','Accept':'application/json'},...c};this.interceptors={request:new i,response:new i}}async request(c){const r={...this.defaults,...c,h:{...this.defaults.headers,...c.headers}},t=await this.interceptors.request.execute(r),e=await this._executeRequest(t),s=await this.interceptors.response.execute(e);return s}async _executeRequest(c){const r=this._buildURL(c),t=new AbortController,e=setTimeout(()=>t.abort(),c.timeout);try{const s=await fetch(r,{method:c.method||'GET',headers:c.headers,body:c.data?JSON.stringify(c.data):void 0,signal:t.signal});clearTimeout(e);const a=s.headers.get('content-type'),o=a&&a.includes('application/json')?await s.json():await s.text();return{data:o,status:s.status,statusText:s.statusText,headers:Object.fromEntries(s.headers.entries()),config:c}}catch(r){clearTimeout(e);throw{message:r.name==='AbortError'?`Request timeout after ${c.timeout}ms`:r.message,config:c,isSiosError:!0,code:r.name==='AbortError'?'TIMEOUT':'NETWORK_ERROR'}}}_buildURL(c){let r=c.baseURL?c.baseURL+c.url:c.url;return c.params&&(r+=`${r.includes('?')?'&':'?'}${new URLSearchParams(c.params)}`),r}get(r,t){return this.request({...t,method:'GET',url:r})}post(r,t,e){return this.request({...e,method:'POST',url:r,data:t})}put(r,t,e){return this.request({...e,method:'PUT',url:r,data:t})}patch(r,t,e){return this.request({...e,method:'PATCH',url:r,data:t})}delete(r,t){return this.request({...t,method:'DELETE',url:r})}head(r,t){return this.request({...t,method:'HEAD',url:r})}options(r,t){return this.request({...t,method:'OPTIONS',url:r})}}class i{constructor(){this.handlers=[]}use(t,e=null){const s=this.handlers.length;return this.handlers.push({id:s,onFulfilled:t,onRejected:e}),s}eject(t){this.handlers[t]&&(this.handlers[t]=null)}async execute(t){let e=t;for(const s of this.handlers)if(s)try{e=await s.onFulfilled(e)}catch(t){if(s.onRejected)e=await s.onRejected(t);else throw t}return e}}const s=new Sios;s.create=t=>new Sios(t);typeof window<'u'&&!window.Sios&&!window.sios&&(window.Sios=Sios,window.sios=s);export default s;
